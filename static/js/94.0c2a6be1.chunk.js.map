{"version":3,"file":"static/js/94.0c2a6be1.chunk.js","mappings":"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","sources":["webpack://dada-chinese/./src/components/cart/css/checkout-item.module.css?6584","components/cart/CheckoutCartItem.js","webpack://dada-chinese/./src/pages/css/checkout.module.css?c1f4","pages/Checkout.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"item\":\"checkout-item_item__ds-f5\",\"title\":\"checkout-item_title__Q75xj\",\"price\":\"checkout-item_price__Q4+Ir\",\"quantity\":\"checkout-item_quantity__R6c8N\"};","import styles from './css/checkout-item.module.css';\n\nconst CheckoutCartItem = ({ title, price, quantity }) => {\n    return (\n        <>\n            <div className={styles.item}>\n                <p className={styles.title}>{title}</p>\n                {quantity > 1 && <p className={styles.quantity}>x{quantity}</p>}\n                {price ? <p className={styles.price}>${price}</p> : <p className={styles.price}>Price</p>}\n            </div>\n        </>\n    );\n}\n\nexport default CheckoutCartItem;","// extracted by mini-css-extract-plugin\nexport default {\"wrap\":\"checkout_wrap__qFQpx\",\"form\":\"checkout_form__8VUDs\",\"section\":\"checkout_section__IudwW\",\"subtitle\":\"checkout_subtitle__74zhl\",\"total\":\"checkout_total__8FLne\",\"total__text\":\"checkout_total__text__LDVRi\",\"summary\":\"checkout_summary__I3BxR\",\"list-wrap\":\"checkout_list-wrap__f35ZQ\",\"box-wrap\":\"checkout_box-wrap__HStVi\",\"input\":\"checkout_input__nBZ9u\",\"border-change\":\"checkout_border-change__cFH4P\",\"credit\":\"checkout_credit__IWI6i\",\"hover\":\"checkout_hover__LnPz9\"};","import { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useNavigate } from \"react-router\";\n\nimport CheckoutCartItem from '../components/cart/CheckoutCartItem';\nimport Paypal from '../components/cart/Paypal';\nimport Button from '../components/util/Button';\nimport { cartActions } from \"../store/redux/cart\";\nimport mainStyles from './../components/main.module.css';\nimport styles from './css/checkout.module.css';\nimport formStyles from './../components/contact/css/contact-form.module.css';\n\nconst Checkout = () => {\n    const cart = useSelector((state) => state.cart);\n\n    const [showPaypal, setShowPaypal] = useState(false);\n    const [hasError, setHasError] = useState();\n    const [usingCredit, setUsingCredit] = useState(false);\n    const [totalPrice, setTotalPrice] = useState(cart.totalPrice);\n\n    const textbook = cart.items.findIndex((item) => item.id === 't1');\n\n    const navigate = useNavigate();\n    const dispatch = useDispatch();\n    \n    const addressRef = useRef();\n    const aptNumRef = useRef();\n    const nameRef = useRef();\n    const emailRef = useRef();\n    \n    const submitHandler = () => {\n        let address = '';\n        if (textbook !== -1) {\n            address = aptNumRef.current.value.trim() !== '' ? addressRef.current.value + ' Apt #: ' + aptNumRef.current.value : addressRef.current.value;\n        }\n        let error = false;\n        let url = 'https://dada-chinese-rest-api.herokuapp.com/shop/new-order';\n        let guestUrl = 'https://dada-chinese-rest-api.herokuapp.com/shop/new-order-guest';\n        let email = null;\n        if (!localStorage.getItem('token')) {\n            email = emailRef.current.value;\n        }\n\n        let body = JSON.stringify({ \n            items: cart.items, \n            totalPrice: cart.totalPrice\n        });\n\n        let guestBody = JSON.stringify({ \n            items: cart.items, \n            totalPrice: cart.totalPrice,\n            address: address,\n            name: !localStorage.getItem('token') ? nameRef.current.value : '',\n            email: !localStorage.getItem('token') ? emailRef.current.value : '',\n        });\n\n        const headers = {\n            \"Content-Type\": \"application/json\",\n            Authorization: 'Bearer ' + localStorage.getItem('token')\n        }\n        \n        const guestHeaders = {\n            \"Content-Type\": \"application/json\"\n        }\n        \n        fetch(localStorage.getItem('token') !== null ? url : guestUrl, {\n            method: 'PUT',\n            body: localStorage.getItem('token') !== null ? body : guestBody,\n            headers: localStorage.getItem('token') !== null ? headers : guestHeaders\n        }).then((result) => {\n            if (!result.ok) {\n                error = true;\n            }\n            \n            return result.json();\n        }).then((data) => {\n            if (error) {\n                setHasError(data.error);\n                return;\n            } else {\n                url = 'https://dada-chinese-rest-api.herokuapp.com/shop/order-email';\n                guestUrl = 'https://dada-chinese-rest-api.herokuapp.com/shop/order-email-guest'\n                body = JSON.stringify({ cartItems: cart.items });\n                guestBody = JSON.stringify({ \n                    cartItems: cart.items,\n                    email: email,\n                });\n                console.log(data.message);\n                fetch(localStorage.getItem('token') !== null ? url : guestUrl, {\n                    method: 'POST',\n                    body: localStorage.getItem('token') !== null ? body : guestBody,\n                    headers: localStorage.getItem('token') !== null ? headers : guestHeaders\n                }).then().catch();\n            }\n        }).then(() => {\n            if (usingCredit) {\n                fetch('https://dada-chinese-rest-api.herokuapp.com/shop/use-credit', {\n                    method: 'POST',\n                    body: JSON.stringify({ creditUsed: cart.totalPrice - cart.creditPrice }),\n                    headers: {\n                        'Content-Type': 'Application/json',\n                        Authorization: 'Bearer ' + localStorage.getItem('token')\n                    }\n                }).then((response) => {\n                    return response.json();\n                }).then((data) => {\n                    console.log(data);\n                    navigate('/dada-chinese/order-confirmation');\n                    dispatch(cartActions.resetCart({ guest: localStorage.getItem('token') === null }));\n                    dispatch(cartActions.updateCredit((cart.totalPrice - cart.creditPrice) - ((cart.totalPrice - cart.creditPrice) * 2)));\n                }).catch((err) => {\n                    setHasError(err.message);\n                    console.log(err);\n                })\n            }\n        }).catch((err) => {\n            setHasError(err.message);\n            console.log(err);\n        });\n    }\n\n\n    const toggleCheckout = (event) => {\n        event.preventDefault();\n\n        if ((textbook !== -1 && addressRef.current.value.trim() === '') || (!localStorage.getItem('token')) && (nameRef.current.value.trim() === '' || emailRef.current.value.trim() === '')) {\n            return setHasError('Please fill out the entirety of the form');\n        }\n        setShowPaypal((prevState) => !prevState);\n    }\n\n    const creditHandler = () => {\n        setUsingCredit((prevState) => !prevState);\n    }\n\n    useEffect(() => {\n        if (usingCredit) {\n            setTotalPrice(cart.creditPrice);\n        } else {\n            setTotalPrice(cart.totalPrice);\n        }\n    }, [usingCredit]);\n\n    useEffect(() => {\n        setTotalPrice(cart.totalPrice);\n    }, [cart.totalPrice]);\n\n    return (\n        <>\n            <p className={mainStyles.title}>Checkout</p>\n            <div className={styles.wrap}>\n                <div className={styles['box-wrap']}>\n                    <div className={styles['list-wrap']}>\n                        <p className={styles.summary}>Summary</p>\n                        {cart.items.map((item) => (\n                            <CheckoutCartItem \n                                key={item.title}\n                                title={item.title} \n                                price={item.price} \n                                quantity={item.quantity} \n                            />\n                        ))}\n                        <div className={styles.total}>\n                            <p className={styles['total__text']}>Total:</p>\n                            <p className={styles['total__text']}>${totalPrice}</p>\n                        </div>\n                    </div>\n                    <div className={styles.section}>\n                        {hasError && <p className={mainStyles.error}>{hasError}</p>}\n                        <form className={styles.form} onSubmit={toggleCheckout}>\n                            {!localStorage.getItem('token') && <>\n                                <p className={styles.subtitle}>Basic Info</p>\n\n                                <fieldset>\n                                    <legend>Name</legend>\n                                    <input name=\"name\" className={styles.input} type=\"text\" ref={nameRef} />\n                                </fieldset>\n\n                                <fieldset>\n                                    <legend>Email</legend>\n                                    <input name=\"email\" className={styles.input} type=\"text\" ref={emailRef} />\n                                </fieldset>\n                            </>}\n                            {textbook !== -1 && <>\n                                <p className={styles.subtitle}>Shipping Info</p>\n\n                                <fieldset>\n                                    <legend>Address</legend>\n                                    <input name=\"address\" className={styles.input} type='text' ref={addressRef} />\n                                </fieldset>\n\n                                <fieldset>\n                                    <legend>Apt # (optional)</legend>\n                                    <input type='text' className={styles.input} ref={aptNumRef} />\n                                </fieldset>\n                            </>}\n                            {(localStorage.getItem('token') && textbook === -1) && <p className={mainStyles.title}>Thank you for choosing Dada Chinese!</p>}\n                            {/* {localStorage.getItem('token') && cart.credit > 0 && <button className={styles.credit} onClick={creditHandler}>{usingCredit ? 'Don\\'t u' : 'U'}se Credit</button>} */}\n                            <div className={styles.wrap}>\n                                {!showPaypal ? <Button onClick={toggleCheckout}>Pay</Button> : totalPrice !== 0 && <Paypal onApprove={submitHandler} totalAmount={totalPrice} />}\n                                {totalPrice === 0 && <Button onClick={submitHandler}>Continue</Button>}\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </>\n    );\n}\n\nexport default Checkout;"],"names":["title","price","quantity","className","styles","cart","useSelector","state","useState","showPaypal","setShowPaypal","hasError","setHasError","usingCredit","totalPrice","setTotalPrice","textbook","items","findIndex","item","id","navigate","useNavigate","dispatch","useDispatch","addressRef","useRef","aptNumRef","nameRef","emailRef","submitHandler","address","current","value","trim","error","url","guestUrl","email","localStorage","getItem","body","JSON","stringify","guestBody","name","headers","Authorization","guestHeaders","fetch","method","then","result","ok","json","data","cartItems","console","log","message","catch","creditUsed","creditPrice","response","cartActions","guest","err","toggleCheckout","event","preventDefault","prevState","useEffect","mainStyles","map","onSubmit","type","ref","Paypal","onApprove","totalAmount","Button","onClick"],"sourceRoot":""}