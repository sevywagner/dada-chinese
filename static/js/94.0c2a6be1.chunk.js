"use strict";(self.webpackChunkdada_chinese=self.webpackChunkdada_chinese||[]).push([[94],{7094:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var s=n(9439),a=n(2791),c=n(9434),r=n(7689),i="checkout-item_item__ds-f5",l="checkout-item_title__Q75xj",o="checkout-item_price__Q4+Ir",u="checkout-item_quantity__R6c8N",d=n(184),h=function(e){var t=e.title,n=e.price,s=e.quantity;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:i,children:[(0,d.jsx)("p",{className:l,children:t}),s>1&&(0,d.jsxs)("p",{className:u,children:["x",s]}),n?(0,d.jsxs)("p",{className:o,children:["$",n]}):(0,d.jsx)("p",{className:o,children:"Price"})]})})},m=n(100),p=n(2845),f=n(7558),g=n(3264),x="checkout_wrap__qFQpx",j="checkout_form__8VUDs",_="checkout_section__IudwW",k="checkout_subtitle__74zhl",N="checkout_total__8FLne",S="checkout_total__text__LDVRi",v="checkout_summary__I3BxR",y="checkout_list-wrap__f35ZQ",I="checkout_box-wrap__HStVi",P="checkout_input__nBZ9u",C=(n(4644),function(){var e=(0,c.v9)((function(e){return e.cart})),t=(0,a.useState)(!1),n=(0,s.Z)(t,2),i=n[0],l=n[1],o=(0,a.useState)(),u=(0,s.Z)(o,2),C=u[0],Z=u[1],b=(0,a.useState)(!1),w=(0,s.Z)(b,2),A=w[0],T=(w[1],(0,a.useState)(e.totalPrice)),O=(0,s.Z)(T,2),R=O[0],F=O[1],q=e.items.findIndex((function(e){return"t1"===e.id})),B=(0,r.s0)(),J=(0,c.I0)(),U=(0,a.useRef)(),D=(0,a.useRef)(),Q=(0,a.useRef)(),z=(0,a.useRef)(),E=function(){var t="";-1!==q&&(t=""!==D.current.value.trim()?U.current.value+" Apt #: "+D.current.value:U.current.value);var n=!1,s="https://dada-chinese-rest-api.herokuapp.com/shop/new-order",a="https://dada-chinese-rest-api.herokuapp.com/shop/new-order-guest",c=null;localStorage.getItem("token")||(c=z.current.value);var r=JSON.stringify({items:e.items,totalPrice:e.totalPrice}),i=JSON.stringify({items:e.items,totalPrice:e.totalPrice,address:t,name:localStorage.getItem("token")?"":Q.current.value,email:localStorage.getItem("token")?"":z.current.value}),l={"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},o={"Content-Type":"application/json"};fetch(null!==localStorage.getItem("token")?s:a,{method:"PUT",body:null!==localStorage.getItem("token")?r:i,headers:null!==localStorage.getItem("token")?l:o}).then((function(e){return e.ok||(n=!0),e.json()})).then((function(t){n?Z(t.error):(s="https://dada-chinese-rest-api.herokuapp.com/shop/order-email",a="https://dada-chinese-rest-api.herokuapp.com/shop/order-email-guest",r=JSON.stringify({cartItems:e.items}),i=JSON.stringify({cartItems:e.items,email:c}),console.log(t.message),fetch(null!==localStorage.getItem("token")?s:a,{method:"POST",body:null!==localStorage.getItem("token")?r:i,headers:null!==localStorage.getItem("token")?l:o}).then().catch())})).then((function(){A&&fetch("https://dada-chinese-rest-api.herokuapp.com/shop/use-credit",{method:"POST",body:JSON.stringify({creditUsed:e.totalPrice-e.creditPrice}),headers:{"Content-Type":"Application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){return e.json()})).then((function(t){console.log(t),B("/dada-chinese/order-confirmation"),J(f.U.resetCart({guest:null===localStorage.getItem("token")})),J(f.U.updateCredit(e.totalPrice-e.creditPrice-2*(e.totalPrice-e.creditPrice)))})).catch((function(e){Z(e.message),console.log(e)}))})).catch((function(e){Z(e.message),console.log(e)}))},V=function(e){if(e.preventDefault(),-1!==q&&""===U.current.value.trim()||!localStorage.getItem("token")&&(""===Q.current.value.trim()||""===z.current.value.trim()))return Z("Please fill out the entirety of the form");l((function(e){return!e}))};return(0,a.useEffect)((function(){F(A?e.creditPrice:e.totalPrice)}),[A]),(0,a.useEffect)((function(){F(e.totalPrice)}),[e.totalPrice]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:g.Z.title,children:"Checkout"}),(0,d.jsx)("div",{className:x,children:(0,d.jsxs)("div",{className:I,children:[(0,d.jsxs)("div",{className:y,children:[(0,d.jsx)("p",{className:v,children:"Summary"}),e.items.map((function(e){return(0,d.jsx)(h,{title:e.title,price:e.price,quantity:e.quantity},e.title)})),(0,d.jsxs)("div",{className:N,children:[(0,d.jsx)("p",{className:S,children:"Total:"}),(0,d.jsxs)("p",{className:S,children:["$",R]})]})]}),(0,d.jsxs)("div",{className:_,children:[C&&(0,d.jsx)("p",{className:g.Z.error,children:C}),(0,d.jsxs)("form",{className:j,onSubmit:V,children:[!localStorage.getItem("token")&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:k,children:"Basic Info"}),(0,d.jsxs)("fieldset",{children:[(0,d.jsx)("legend",{children:"Name"}),(0,d.jsx)("input",{name:"name",className:P,type:"text",ref:Q})]}),(0,d.jsxs)("fieldset",{children:[(0,d.jsx)("legend",{children:"Email"}),(0,d.jsx)("input",{name:"email",className:P,type:"text",ref:z})]})]}),-1!==q&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:k,children:"Shipping Info"}),(0,d.jsxs)("fieldset",{children:[(0,d.jsx)("legend",{children:"Address"}),(0,d.jsx)("input",{name:"address",className:P,type:"text",ref:U})]}),(0,d.jsxs)("fieldset",{children:[(0,d.jsx)("legend",{children:"Apt # (optional)"}),(0,d.jsx)("input",{type:"text",className:P,ref:D})]})]}),localStorage.getItem("token")&&-1===q&&(0,d.jsx)("p",{className:g.Z.title,children:"Thank you for choosing Dada Chinese!"}),(0,d.jsxs)("div",{className:x,children:[i?0!==R&&(0,d.jsx)(m.Z,{onApprove:E,totalAmount:R}):(0,d.jsx)(p.Z,{onClick:V,children:"Pay"}),0===R&&(0,d.jsx)(p.Z,{onClick:E,children:"Continue"})]})]})]})]})})]})})}}]);
//# sourceMappingURL=94.0c2a6be1.chunk.js.map